@startuml
title Diagrama de Atividade - Cadastro e Login de Usuário

skinparam handwritten true
skinparam activity {
  BorderColor #5E81AC
  BackgroundColor #ECEFF4
  ArrowColor #D08770
}

|Visitante|
start
:Acessar a plataforma (localhost:3000);
if (Possui conta?) then (Sim)
  :Acessar a tela de Login;
else (Não)
  |Frontend|
  :Exibir tela de Cadastro;
  :Preencher formulário (nome, email, senha);
  :Validar dados do formulário (Zod);
  if (Dados são válidos?) then (Sim)
    |Backend|
    :Receber requisição (POST /users);
    :Verificar se o email já existe no banco;
    if (Email é único?) then (Sim)
      :Gerar hash da senha;
      :Salvar novo usuário no banco de dados (Prisma);
      |Frontend|
      :Exibir mensagem de sucesso;
      :Redirecionar para a tela de Login;
    else (Não)
      |Frontend|
      :Exibir erro "Email já cadastrado";
      stop
    endif
  else (Não)
    :Exibir erros de validação no formulário;
    stop
  endif
endif

|Frontend|
:Preencher formulário (email, senha);
:Clicar em "Login";

|Backend|
:Receber requisição (POST /login);
:Buscar usuário pelo email;
:Comparar hash da senha;
if (Credenciais são válidas?) then (Sim)
  :Gerar token JWT;
  :Retornar token e dados do usuário;
  |Frontend|
  :Armazenar o token de autenticação;
  :Redirecionar para a área logada;
  |Usuário Autenticado|
  :Visualizar o painel principal;
  stop
else (Não)
  |Frontend|
  :Exibir mensagem "Email ou senha inválidos";
  stop
endif

@enduml
